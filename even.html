

<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <title>Even Semester SGPA Predictor</title>
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
Â  <link rel="stylesheet" href="predictor4.css">
Â  <style>
Â Â Â  body {
Â Â Â Â Â  font-family: Arial, sans-serif;
Â Â Â Â Â  padding: 20px;
Â Â Â Â Â  background: #1e1e1e;
Â Â Â Â Â  color: #f0f0f0;
Â Â Â  }
Â Â Â  h1, h2, h3 { color: #f0f0f0; }
Â Â Â  .subject-group {
Â Â Â Â Â  display: flex;
Â Â Â Â Â  align-items: center;
Â Â Â Â Â  gap: 10px;
Â Â Â Â Â  margin-bottom: 10px;
Â Â Â  }
Â Â Â  label { width: 280px; font-weight: bold; }
Â Â Â  input[type="number"] { width: 100px; padding: 5px; }
Â Â Â  .output-table {
Â Â Â Â Â  width: 100%;
Â Â Â Â Â  border-collapse: collapse;
Â Â Â Â Â  margin-top: 10px;
Â Â Â  }
Â Â Â  .output-table th, .output-table td {
Â Â Â Â Â  border: 1px solid #ccc;
Â Â Â Â Â  padding: 8px;
Â Â Â Â Â  text-align: center;
Â Â Â  }
Â Â Â  .possible { background-color: #24532f; }
Â Â Â  .not-possible { background-color: #772020; }
Â Â Â  .realistic { background-color: #786214; }
Â Â Â  .top-bar {
Â Â Â Â Â  display: flex;
Â Â Â Â Â  justify-content: space-between;
Â Â Â Â Â  align-items: center;
Â Â Â  }
Â Â Â  .info { font-size: 14px; color: #aaa; }
Â Â Â  button {
Â Â Â Â Â  padding: 8px 15px;
Â Â Â Â Â  margin: 10px 5px;
Â Â Â Â Â  cursor: pointer;
Â Â Â  }
Â  </style>
</head>
<body> 

<div class="top-bar">
Â  <h1 id="title">Even Semester SGPA Predictor</h1>
Â  <button onclick="logout()">Logout</button>
</div> 

<p class="info" id="userInfo"></p> 

<div id="form"></div> 

<button onclick="predictGrades()">Predict SGPA</button>
<button onclick="clearInputs()">Clear Data</button>
<button onclick="viewHistory()">ðŸ“œ View History</button>
<button onclick="clearHistory()">ðŸ§¹ Clear History</button> 

<div id="result"></div>
<div id="history"></div> 

<script>
/* ===========================
Â Â  ðŸ” AUTH + SEM VALIDATION
=========================== */
const name = localStorage.getItem("name");
const semester = localStorage.getItem("semester"); 

if (!name || !["2", "4", "6"].includes(semester)) {
Â  alert("Unauthorized access");
Â  logout();
} 

document.getElementById("userInfo").innerText =
Â  `ðŸ‘¤ ${name} | Semester: ${semester}`;
document.getElementById("title").innerText =
Â  `${semester}th Semester SGPA Predictor`; 

/* ===========================
Â Â  ðŸ“˜ EVEN SEM SUBJECT DATA
=========================== */
const semesterSubjects = {
Â  "2": [
Â Â Â  { name: "Mathematics", credits: 4, isHalf: false },
Â Â Â  { name: "Physics", credits: 3, isHalf: false },
Â Â Â  { name: "English", credits: 1, isHalf: true },
Â Â Â  { name: "Kannada", credits: 1, isHalf: true },
Â Â Â  { name: "Health", credits: 1, isHalf: true },
Â Â Â  { name: "Basic Electronics", credits: 3, isHalf: false },
Â Â Â  { name: "ESC", credits: 3, isHalf: false },
Â Â Â  { name: "PLC", credits: 3, isHalf: false },
Â Â Â  { name: "Physics Lab", credits: 1, isHalf: true }
Â  ], 

Â  "4": [
Â Â Â  { name: "Control Systems", credits: 4, isHalf: false },
Â Â Â  { name: "Biomedical Signal Processing", credits: 3, isHalf: false },
Â Â Â  { name: "RTES", credits: 3, isHalf: false },
Â Â Â  { name: "LIC", credits: 3, isHalf: false },
Â Â Â  { name: "Maths", credits: 3, isHalf: false },
Â Â Â  { name: "AEC â€“ Telemedicine", credits: 1, isHalf: true },
Â Â Â  { name: "BSP Lab", credits: 1, isHalf: true },
Â Â Â  { name: "LIC Lab", credits: 1, isHalf: true },
Â Â Â  { name: "RTES Lab", credits: 1, isHalf: true }
Â  ], 

Â  "6": [
Â Â Â  { name: "BMIP", credits: 4, isHalf: false },
Â Â Â  { name: "MINI Project", credits: 4, isHalf: true },
Â Â Â  { name: "Biostatistics/Biomechanics", credits: 3, isHalf: false },
Â Â Â  { name: "MDD/MDR", credits: 3, isHalf: false },
Â Â Â  { name: "M&E", credits: 3, isHalf: false },
Â Â Â  { name: "OE", credits: 3, isHalf: false },
Â Â Â  { name: "BMIP Lab", credits: 1, isHalf: true },
Â Â Â  { name: "DNT Lab", credits: 1, isHalf: true }
Â  ]
}; 

const subjects = semesterSubjects[semester]; 

/* ===========================
Â Â  ðŸŽ“ GRADING LOGIC
=========================== */
const grades = [10, 9, 8, 7, 6, 5, 0];
const gradeLabels = {10:"O",9:"A+",8:"A",7:"B+",6:"B",5:"C",0:"F"};
const selectedGrades = {}; 

/* ===========================
Â Â  ðŸ§± BUILD FORM
=========================== */
const form = document.getElementById("form");
subjects.forEach((sub, i) => {
Â  const div = document.createElement("div");
Â  div.className = "subject-group";
Â  div.innerHTML = `
Â Â Â  <label>${sub.name} (Internal Marks):</label>
Â Â Â  <input type="number" id="sub${i}" min="0" max="50">
Â  `;
Â  form.appendChild(div);
}); 

/* ===========================
Â Â  ðŸ“Š CALCULATION FUNCTIONS
=========================== */
function calculateRequiredMarks(internal, grade, isHalf) {
Â  const lower = {10:90,9:80,8:70,7:60,6:50,5:40}[grade];
Â  if (!lower) return -1;
Â  const req = isHalf ? (lower - internal) : 2 * (lower - internal);
Â  const max = isHalf ? 50 : 100;
Â  return (req < 0 || req > max) ? -1 : req;
} 

function predictGrades() {
Â  document.getElementById("result").innerHTML = "";
Â  Object.keys(selectedGrades).forEach(k => delete selectedGrades[k]); 

Â  let html = ""; 

Â  subjects.forEach((sub, i) => {
Â Â Â  const internal = parseFloat(document.getElementById(`sub${i}`).value);
Â Â Â  if (isNaN(internal)) return; 

Â Â Â  html += `<h3>${sub.name}</h3><table class="output-table"><tr>`;
Â Â Â  grades.forEach(g => html += `<th>${gradeLabels[g]}</th>`);
Â Â Â  html += `</tr><tr>`; 

Â Â Â  grades.forEach(g => {
Â Â Â Â Â  const r = calculateRequiredMarks(internal, g, sub.isHalf);
Â Â Â Â Â  const cls = r === -1 ? "not-possible" :
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  (r <= (sub.isHalf ? 45 : 86) ? "realistic" : "possible");
Â Â Â Â Â  html += `<td class="${cls}">${r === -1 ? "-" : r.toFixed(1)}</td>`;
Â Â Â  }); 

Â Â Â  html += `</tr></table>`; 

Â Â Â  let def = 0;
Â Â Â  for (let g of grades) {
Â Â Â Â Â  const r = calculateRequiredMarks(internal, g, sub.isHalf);
Â Â Â Â Â  if (r !== -1 && r <= (sub.isHalf ? 45 : 86)) { def = g; break; }
Â Â Â  } 

Â Â Â  selectedGrades[sub.name] = def; 

Â Â Â  html += `<p><strong>Select Expected Grade:</strong><br>`;
Â Â Â  grades.forEach(g => {
Â Â Â Â Â  html += `
Â Â Â Â Â Â Â  <label>
Â Â Â Â Â Â Â Â Â  <input type="radio" name="g${i}" ${g===def?"checked":""}
Â Â Â Â Â Â Â Â Â  onchange="updateSelectedGrade('${sub.name}',${g})">
Â Â Â Â Â Â Â Â Â  ${gradeLabels[g]}
Â Â Â Â Â Â Â  </label>
Â Â Â Â Â  `;
Â Â Â  });
Â Â Â  html += `</p>`;
Â  }); 

Â  document.getElementById("result").innerHTML = html;
Â  updateSGPA();
} 

function updateSelectedGrade(sub, g) {
Â  selectedGrades[sub] = g;
Â  updateSGPA();
} 

function updateSGPA() {
Â  let tc=0,tp=0;
Â  subjects.forEach(s=>{
Â Â Â  if (selectedGrades[s.name] !== undefined) {
Â Â Â Â Â  tc += s.credits;
Â Â Â Â Â  tp += selectedGrades[s.name] * s.credits;
Â Â Â  }
Â  });
Â  const sgpa = (tp/tc).toFixed(2);
Â  document.getElementById("result")
Â Â Â  .insertAdjacentHTML("beforeend", `<h2>ðŸŽ¯ SGPA: ${sgpa}</h2>`);
Â  saveResult(sgpa);
} 

/* ===========================
Â Â  ðŸŒ BACKEND FUNCTIONS
=========================== */
function saveResult(sgpa) {
Â  fetch("https://sgpa-backend-m676.onrender.com/save-history", {
Â Â Â  method:"POST",
Â Â Â  headers:{ "Content-Type":"application/json" },
Â Â Â  body:JSON.stringify({ name, semester, result:sgpa, grades:selectedGrades })
Â  });
} 

function viewHistory() {
Â  fetch(`https://sgpa-backend-m676.onrender.com/history/${name}`)
Â Â Â  .then(r=>r.json())
Â Â Â  .then(d=>{
Â Â Â Â Â  let h="<h3>ðŸ“œ History</h3><ul>";
Â Â Â Â Â  d.history.forEach(x=>{
Â Â Â Â Â Â Â  h+=`<li>${new Date(x.date).toLocaleString()} â€” ${x.result}</li>`;
Â Â Â Â Â  });
Â Â Â Â Â  h+="</ul>";
Â Â Â Â Â  document.getElementById("history").innerHTML=h;
Â Â Â  });
} 

function clearHistory() {
Â  fetch(`https://sgpa-backend-m676.onrender.com/history/${name}`,{method:"DELETE"})
Â Â Â  .then(()=>document.getElementById("history").innerHTML="");
} 

function clearInputs() {
Â  subjects.forEach((_,i)=>document.getElementById(`sub${i}`).value="");
Â  document.getElementById("result").innerHTML="";
} 

function logout() {
Â  localStorage.clear();
Â  window.location.href = "index.html";
}
</script> 

</body>
</html>
